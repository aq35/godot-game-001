# 📡 EventBus.gd とは？（簡単版）

## 💡 一言で言うと
**EventBus = みんなが聞ける「放送局」**

## 🔍 問題：普通の方法だと...

```gdscript
# プレイヤーがコインを取った時
# Player.gd
func collect_coin():
    coins += 1
    
    # スコア表示を更新したい...でも、どうやって？
    # UI.update_score(coins)  # ← UIがどこにあるか分からない！
    # Audio.play_sound()      # ← 音も鳴らしたい
    # Achievement.check()     # ← 実績もチェックしたい
```

**問題：** Player.gd が他のシステム全部を知らないといけない

## ✅ EventBus を使うと...

```gdscript
# プレイヤーがコインを取った時
# Player.gd  
func collect_coin():
    coins += 1
    EventBus.coin_collected.emit(coins)  # 「コイン取ったよー！」と放送

# 興味のあるシステムが勝手に聞いてる
# UI.gd
func _ready():
    EventBus.coin_collected.connect(_on_coin_collected)
func _on_coin_collected(coin_count):
    score_label.text = str(coin_count)

# Audio.gd  
func _ready():
    EventBus.coin_collected.connect(_on_coin_collected)
func _on_coin_collected(coin_count):
    play_sound("coin_pickup")

# Achievement.gd
func _ready():
    EventBus.coin_collected.connect(_on_coin_collected) 
func _on_coin_collected(coin_count):
    if coin_count >= 100:
        unlock_achievement("コインマスター")
```

## 🎯 EventBus の仕組み

### **放送局のイメージ**
```
プレイヤー → EventBus → 「コイン取得！」を放送
                ↓
    ┌─────────┬─────────┬─────────┐
   UI      Audio    実績    (聞きたい人だけ聞く)
```

### **実際のコード構造**
```gdscript
# EventBus.gd (AutoLoad)
extends Node

# 放送できるイベント一覧
signal coin_collected(count: int)
signal player_died
signal level_completed
signal chat_message_received(message: String)

# 放送用のヘルパー関数（オプション）
func emit_coin_collected(count: int):
    coin_collected.emit(count)
    print("🪙 コイン取得！ 合計:", count)
```

## 🔄 マルチプレイヤーゲームでの活用例

```gdscript
# チャットメッセージを受信した時
# Net.gd
func _on_websocket_message(data):
    if data.type == "chat":
        EventBus.chat_message_received.emit(data.message, data.username)

# チャットUI が自動で更新
# ChatPanel.gd  
func _ready():
    EventBus.chat_message_received.connect(_on_message_received)
func _on_message_received(message: String, username: String):
    add_message_to_chat(username + ": " + message)

# 通知システムも自動で反応
# NotificationSystem.gd
func _ready():
    EventBus.chat_message_received.connect(_on_message_received)
func _on_message_received(message: String, username: String):
    show_notification("💬 " + username + " さんがメッセージを送信")
```

## 🎯 EventBus の利点

### **✅ 良いところ**
- **疎結合**: PlayerがUIを知らなくて良い
- **拡張しやすい**: 新機能が簡単に「聞ける」
- **管理しやすい**: イベントが一箇所に集約

### **⚠️ 注意点**
- イベントが多すぎると混乱
- デバッグが少し難しい

## 💡 まとめ

**EventBus = イベントの「放送局」**

```
何かが起きた → EventBus で放送 → 興味のある人が勝手に反応
```

**普通の方法：** 相手を直接呼ぶ電話  
**EventBus：** みんなが聞いてるラジオ放送

これで EventBus の基本は理解できましたか？

Phase 2 で実際に使いながら覚えていきましょう！