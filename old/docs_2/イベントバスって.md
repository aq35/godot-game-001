# ğŸ“¡ EventBus.gd ã¨ã¯ï¼Ÿï¼ˆç°¡å˜ç‰ˆï¼‰

## ğŸ’¡ ä¸€è¨€ã§è¨€ã†ã¨
**EventBus = ã¿ã‚“ãªãŒèã‘ã‚‹ã€Œæ”¾é€å±€ã€**

## ğŸ” å•é¡Œï¼šæ™®é€šã®æ–¹æ³•ã ã¨...

```gdscript
# ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚³ã‚¤ãƒ³ã‚’å–ã£ãŸæ™‚
# Player.gd
func collect_coin():
    coins += 1
    
    # ã‚¹ã‚³ã‚¢è¡¨ç¤ºã‚’æ›´æ–°ã—ãŸã„...ã§ã‚‚ã€ã©ã†ã‚„ã£ã¦ï¼Ÿ
    # UI.update_score(coins)  # â† UIãŒã©ã“ã«ã‚ã‚‹ã‹åˆ†ã‹ã‚‰ãªã„ï¼
    # Audio.play_sound()      # â† éŸ³ã‚‚é³´ã‚‰ã—ãŸã„
    # Achievement.check()     # â† å®Ÿç¸¾ã‚‚ãƒã‚§ãƒƒã‚¯ã—ãŸã„
```

**å•é¡Œï¼š** Player.gd ãŒä»–ã®ã‚·ã‚¹ãƒ†ãƒ å…¨éƒ¨ã‚’çŸ¥ã‚‰ãªã„ã¨ã„ã‘ãªã„

## âœ… EventBus ã‚’ä½¿ã†ã¨...

```gdscript
# ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚³ã‚¤ãƒ³ã‚’å–ã£ãŸæ™‚
# Player.gd  
func collect_coin():
    coins += 1
    EventBus.coin_collected.emit(coins)  # ã€Œã‚³ã‚¤ãƒ³å–ã£ãŸã‚ˆãƒ¼ï¼ã€ã¨æ”¾é€

# èˆˆå‘³ã®ã‚ã‚‹ã‚·ã‚¹ãƒ†ãƒ ãŒå‹æ‰‹ã«èã„ã¦ã‚‹
# UI.gd
func _ready():
    EventBus.coin_collected.connect(_on_coin_collected)
func _on_coin_collected(coin_count):
    score_label.text = str(coin_count)

# Audio.gd  
func _ready():
    EventBus.coin_collected.connect(_on_coin_collected)
func _on_coin_collected(coin_count):
    play_sound("coin_pickup")

# Achievement.gd
func _ready():
    EventBus.coin_collected.connect(_on_coin_collected) 
func _on_coin_collected(coin_count):
    if coin_count >= 100:
        unlock_achievement("ã‚³ã‚¤ãƒ³ãƒã‚¹ã‚¿ãƒ¼")
```

## ğŸ¯ EventBus ã®ä»•çµ„ã¿

### **æ”¾é€å±€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸**
```
ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ â†’ EventBus â†’ ã€Œã‚³ã‚¤ãƒ³å–å¾—ï¼ã€ã‚’æ”¾é€
                â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   UI      Audio    å®Ÿç¸¾    (èããŸã„äººã ã‘èã)
```

### **å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰æ§‹é€ **
```gdscript
# EventBus.gd (AutoLoad)
extends Node

# æ”¾é€ã§ãã‚‹ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§
signal coin_collected(count: int)
signal player_died
signal level_completed
signal chat_message_received(message: String)

# æ”¾é€ç”¨ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
func emit_coin_collected(count: int):
    coin_collected.emit(count)
    print("ğŸª™ ã‚³ã‚¤ãƒ³å–å¾—ï¼ åˆè¨ˆ:", count)
```

## ğŸ”„ ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚²ãƒ¼ãƒ ã§ã®æ´»ç”¨ä¾‹

```gdscript
# ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ãŸæ™‚
# Net.gd
func _on_websocket_message(data):
    if data.type == "chat":
        EventBus.chat_message_received.emit(data.message, data.username)

# ãƒãƒ£ãƒƒãƒˆUI ãŒè‡ªå‹•ã§æ›´æ–°
# ChatPanel.gd  
func _ready():
    EventBus.chat_message_received.connect(_on_message_received)
func _on_message_received(message: String, username: String):
    add_message_to_chat(username + ": " + message)

# é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã‚‚è‡ªå‹•ã§åå¿œ
# NotificationSystem.gd
func _ready():
    EventBus.chat_message_received.connect(_on_message_received)
func _on_message_received(message: String, username: String):
    show_notification("ğŸ’¬ " + username + " ã•ã‚“ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡")
```

## ğŸ¯ EventBus ã®åˆ©ç‚¹

### **âœ… è‰¯ã„ã¨ã“ã‚**
- **ç–çµåˆ**: PlayerãŒUIã‚’çŸ¥ã‚‰ãªãã¦è‰¯ã„
- **æ‹¡å¼µã—ã‚„ã™ã„**: æ–°æ©Ÿèƒ½ãŒç°¡å˜ã«ã€Œèã‘ã‚‹ã€
- **ç®¡ç†ã—ã‚„ã™ã„**: ã‚¤ãƒ™ãƒ³ãƒˆãŒä¸€ç®‡æ‰€ã«é›†ç´„

### **âš ï¸ æ³¨æ„ç‚¹**
- ã‚¤ãƒ™ãƒ³ãƒˆãŒå¤šã™ãã‚‹ã¨æ··ä¹±
- ãƒ‡ãƒãƒƒã‚°ãŒå°‘ã—é›£ã—ã„

## ğŸ’¡ ã¾ã¨ã‚

**EventBus = ã‚¤ãƒ™ãƒ³ãƒˆã®ã€Œæ”¾é€å±€ã€**

```
ä½•ã‹ãŒèµ·ããŸ â†’ EventBus ã§æ”¾é€ â†’ èˆˆå‘³ã®ã‚ã‚‹äººãŒå‹æ‰‹ã«åå¿œ
```

**æ™®é€šã®æ–¹æ³•ï¼š** ç›¸æ‰‹ã‚’ç›´æ¥å‘¼ã¶é›»è©±  
**EventBusï¼š** ã¿ã‚“ãªãŒèã„ã¦ã‚‹ãƒ©ã‚¸ã‚ªæ”¾é€

ã“ã‚Œã§ EventBus ã®åŸºæœ¬ã¯ç†è§£ã§ãã¾ã—ãŸã‹ï¼Ÿ

Phase 2 ã§å®Ÿéš›ã«ä½¿ã„ãªãŒã‚‰è¦šãˆã¦ã„ãã¾ã—ã‚‡ã†ï¼